<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="devil0x菜鸟">
<meta property="og:url" content="https://devil0x.github.io/page/2/index.html">
<meta property="og:site_name" content="devil0x菜鸟">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="devil0x菜鸟">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://devil0x.github.io/page/2/">





  <title>devil0x菜鸟</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">devil0x菜鸟</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://devil0x.github.io/2019/06/20/安洵杯CTF rfid题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="devil0x">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devil0x菜鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/安洵杯CTF rfid题/" itemprop="url">安洵杯CTF rfid题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T03:26:52+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="安洵杯CTF-rfid题"><a href="#安洵杯CTF-rfid题" class="headerlink" title="安洵杯CTF rfid题"></a>安洵杯CTF rfid题</h1><p>首先，这题我也没拿到flag，但是经过喵师傅的讲解，暂时把校验弄出来了。</p>
<p>##　１．为啥自己看不出校验方法呢？我觉得吧，有以下几点需要注意应该会好很多:</p>
<p>1.实验一种校验方法之后没有结果，不要死磕，换方法。</p>
<p>2.加几个破解水卡的群，多接触各种稀奇古怪的校验方法。</p>
<p>3.多练习多练习。。。。</p>
<p>4.用好winhex，逆向计算器</p>
<h6 id="5-最重要的，校验的奥义：羊毛出在羊身上。就是说，校验位在哪里，你可以通过多看几个数据的变化来看出。而校验的产生，总是遵循金额位的变化，校验不管咋变，都是金额位数值通过各种公式组合加计算出来的。"><a href="#5-最重要的，校验的奥义：羊毛出在羊身上。就是说，校验位在哪里，你可以通过多看几个数据的变化来看出。而校验的产生，总是遵循金额位的变化，校验不管咋变，都是金额位数值通过各种公式组合加计算出来的。" class="headerlink" title="5.最重要的，校验的奥义：羊毛出在羊身上。就是说，校验位在哪里，你可以通过多看几个数据的变化来看出。而校验的产生，总是遵循金额位的变化，校验不管咋变，都是金额位数值通过各种公式组合加计算出来的。"></a>5.最重要的，校验的奥义：羊毛出在羊身上。就是说，校验位在哪里，你可以通过多看几个数据的变化来看出。而校验的产生，总是遵循金额位的变化，校验不管咋变，都是金额位数值通过各种公式组合加计算出来的。</h6><h2 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h2><p>1.过一下题目 <img src="http://pico0ziv8.bkt.clouddn.com/18-11-28/94754972.jpg" alt></p>
<p>2.题目提供了4个文件，12.66(2)明显有异常先略过</p>
<p>3.先以15.00为例，12.76,12.66都是一样的规律。</p>
<p>可以看出金额是15.00，根据1500十进制转换到十六进制结果为5 DC，故金额位还是常见的倒置转换。</p>
<p><img src="http://pico0ziv8.bkt.clouddn.com/18-11-28/32155.jpg" alt></p>
<p>4.下一步查看尾部的09 0D</p>
<p>乍一看啥也看不出，我傻不愣登的还是用之前解学校水卡的方法算这个，发现结果总是+1或者-1.经喵神师傅点拨，应该是xor异或校验。</p>
<p>故算一下DC xor 05的值 = </p>
<p><img src="http://pico0ziv8.bkt.clouddn.com/18-11-28/20777601.jpg" alt></p>
<p>出现了东西，因为校验位刚好09 0D。把其他为组也试了一下，通过。</p>
<p>5。但是只发现一位，没法构建题目所需的233.00金额。</p>
<p>然后发现DC xor 09 = </p>
<p> <img src="C:\Users\skywa\AppData\Roaming\Typora\typora-user-images\1543335819698.png" alt></p>
<p><img src="http://pico0ziv8.bkt.clouddn.com/18-11-28/1566315.jpg" alt></p>
<p>还有这个联系。</p>
<p>6.至此可以先构建23300这个金额以及校验位了</p>
<p>23300十六进制之后 =  5b 04 </p>
<p>再5b xor 04 =  5f</p>
<p>先构建如下</p>
<p><img src="http://pico0ziv8.bkt.clouddn.com/18-11-28/42871262.jpg" alt></p>
<p>现在还不能百分百确定x这里该补什么</p>
<p>再经过第二个异或算法：这个xf xor 04 = 5b</p>
<p>所以反算xf = 5b xor 04</p>
<p><img src="http://pico0ziv8.bkt.clouddn.com/18-11-28/96278271.jpg" alt></p>
<p>确定x就是5。</p>
<p>然后补上即可</p>
<h2 id="3-but这两个地方我还是不会，我菜死了。。。。。"><a href="#3-but这两个地方我还是不会，我菜死了。。。。。" class="headerlink" title="3. but这两个地方我还是不会，我菜死了。。。。。"></a>3. but这两个地方我还是不会，我菜死了。。。。。</h2><p><img src="http://pico0ziv8.bkt.clouddn.com/18-11-28/40677886.jpg" alt></p>
<p>所以还是没有flag难受啊！！！！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://devil0x.github.io/2019/06/20/固定码逆向分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="devil0x">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devil0x菜鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/固定码逆向分析/" itemprop="url">固定码逆向分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T03:26:52+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="固定码逆向分析"><a href="#固定码逆向分析" class="headerlink" title="固定码逆向分析"></a>固定码逆向分析</h1><p> 环境：kali</p>
<h2 id="0x01-Analysis-信号分析"><a href="#0x01-Analysis-信号分析" class="headerlink" title="0x01. Analysis 信号分析"></a>0x01. <strong>Analysis 信号分析</strong></h2><p>分析信号可使用音频处理软件Audacity：</p>
<p>不过这种方式需要肉眼将波形转化成0跟1，看起来比较容易眼花。so用软件辅助一下</p>
<h2 id="1-1安装软件"><a href="#1-1安装软件" class="headerlink" title="1.1安装软件"></a>1.1<strong>安装软件</strong></h2><h3 id="1-inspectrum"><a href="#1-inspectrum" class="headerlink" title="1.inspectrum"></a>1.inspectrum</h3><p>在这篇文章中我们将通过inspectrum(<a href="https://github.com/miek/inspectrum" target="_blank" rel="noopener">https://github.com/miek/inspectrum</a>)这个工具来分析信号，配合Python将信号转成二进制数据。</p>
<p>先安装所需的环境，再安装inspectrum。类似的软件还有DSpectrumGUI都行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install qt5-default libfftw3-dev cmake pkg-config libliquid-dev</span><br><span class="line">git clone https://github.com/miek/inspectrum.git </span><br><span class="line">mkdir build </span><br><span class="line">cd build </span><br><span class="line">cmake .. </span><br><span class="line">make </span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<h3 id="2-universal-radio-hacker-urh"><a href="#2-universal-radio-hacker-urh" class="headerlink" title="2. universal radio hacker(urh)"></a>2. universal radio hacker(urh)</h3><p>有windos版直接下载即可</p>
<h3 id="3-HDSHR"><a href="#3-HDSHR" class="headerlink" title="3.HDSHR"></a>3.HDSHR</h3><p>下载之后需要加载一下rt sdr的驱动</p>
<p>地址：<a href="https://github.com/devil0x/wireless-analyze/blob/master/%E8%BD%AF%E4%BB%B6/ExtIO_RTL2832.dll" target="_blank" rel="noopener">https://github.com/devil0x/wireless-analyze/blob/master/%E8%BD%AF%E4%BB%B6/ExtIO_RTL2832.dll</a></p>
<p><img src="https://github.com/devil0x/picture/raw/master/1.19/2.png" alt></p>
<p>即可开始监听特定频段。</p>
<h2 id="0x02-分析文件"><a href="#0x02-分析文件" class="headerlink" title="0x02.分析文件"></a>0x02.分析文件</h2><p>文件地址：<a href="https://github.com/mobier/WirelessSample" target="_blank" rel="noopener">https://github.com/mobier/WirelessSample</a></p>
<h3 id="1-原理"><a href="#1-原理" class="headerlink" title="1.原理"></a>1.原理</h3><p><img src="https://image.3001.net/images/20181211/1544496759_5c0f2677573f8.png!small" alt></p>
<p>摘抄：信号脉冲的宽度跟电压，震荡电阻是有关系的。我们可以算出信号的震荡周期（a=两倍的时钟震荡周期）f=2100016/Rosc(kΩ) kHz 其中 Rosc 为振荡电阻。</p>
<p>我们来看下这两种信号的区别，第一种信号吧 Bit1 相当于 12A 宽度的高电平脉冲加 4A 宽度低电平的脉冲重复一次，而BIt0正好相反是 4a 高在是 12a 的低重复一次。然后说下 BitF，BitF 只会出现在地址位里面，代表该地址位引脚悬空，后面会提到，无效码则不可能出现在 2262 这种协议中，如果出现了只能表示这个信号是 2240 的。</p>
<p>现在来说下第二种信号格式，第二种与第一种不同，非常明显能看出来第一种是把一段信号重复了两次来表示BIT1 和 BIT0，并且有三种表示方式。第二种呢就是 12A 宽度的高电平脉冲信号加上 4A 的低电平宽度脉冲信号就是 BIT1，相反的就是 BIT0，并且不像第一种那样数据有 3 种表示方式。</p>
<h3 id="2-PT226X"><a href="#2-PT226X" class="headerlink" title="2.PT226X"></a>2.PT226X</h3><p><img src="https://image.3001.net/images/20181211/1544496739_5c0f2663762a9.png!small" alt></p>
<p>首先来看一下PT226x的结构</p>
<p>案例是录制的门铃的文件，433.92mhz，ASK调制。</p>
<p><img src="C:\Users\skywa\Pictures\1.19\3.png" alt></p>
<p>录制的文件是raw格式，我用的win10的udr打开的该文件。</p>
<p><img src="https://github.com/devil0x/picture/raw/master/1.19/4.png" alt></p>
<p>选择ask解调。</p>
<p>再放大即可</p>
<p><img src="https://github.com/devil0x/picture/raw/master/1.19/6.png" alt></p>
<p>前部是4bit同步码，后半部分根据结构看的话，先是地址码，再之后为数据码。</p>
<p>图中红线圈起来的刚好是与开始的案例相同的即：FFF0FFFF，再后边的数据码是1111。比对方式见开头图片关于PT226x的部分</p>
<p>当然用另一种方法，直接在选择这样配置即可看出每段的二进制数据。</p>
<p>1是11101110</p>
<p>0是10001000</p>
<p>F是10001110</p>
<p><img src="https://github.com/devil0x/picture/raw/master/1.19/13.png" alt></p>
<h3 id="3-PT224X"><a href="#3-PT224X" class="headerlink" title="3.PT224X"></a>3.PT224X</h3><p><img src="https://image.3001.net/images/20181211/1544496739_5c0f266399bbe.png!small" alt></p>
<p>首先依旧是PT224X的结构部分，同样是先同步码后地址码再数据位的结构。</p>
<p>区别就是位数更长。还有一个区别2240和2262的方法，只要有F就肯定是226X。</p>
<p>案例给了2个录制好的文件，一个niu2.cs8，另一个PT2242.cs8。直接拖进urh打开是混乱的，可以先用audacity选择导入原数据。</p>
<p><img src="https://github.com/devil0x/picture/raw/master/1.19/8.png" alt></p>
<p>其次再选中空白部分直接剪掉即可，在导出为wav文件，直接用urh打开就可以看到波形图，再ASK调制，下方有个Autodetect parameters按钮点击一下即可，然后即可看出转换出的二进制数据。当然也可以选择inspectrum进行，但是感觉用urh似乎跟简单一些。</p>
<p><img src="https://github.com/devil0x/picture/raw/master/1.19/11.png" alt></p>
<p>然后底下就可以看出了、</p>
<p><img src="https://github.com/devil0x/picture/raw/master/1.19/12.png" alt></p>
<p>首先是1以及后边一大串空白是同步码，再然后底下 即可看出了，但是要记得在每行的最后一位空一个1，这个是下一段同步码的开始点位。现在选中的地方就是地址码加数据码的数据，没一个二进制数据由4个数字组成，Bit1 相当于 12A 宽度的高电平脉冲加 4A 宽度低电平的脉冲重复一次，而BIt0正好相反是 4a 高在是 12a 的低重复一次。</p>
<p>然后直接可以看出1000代表0,1110代表1.</p>
<h2 id="0x02-自制设备"><a href="#0x02-自制设备" class="headerlink" title="0x02.自制设备"></a>0x02.自制设备</h2><p>在淘宝可以搜到很多的非法设备，such as ：a890，还有什么d10m啥的，一般在淘宝咸鱼都是这样婶儿的。。。</p>
<p><img src="https://github.com/devil0x/picture/raw/master/1.19/15.png" alt></p>
<p><img src="https://github.com/devil0x/picture/raw/master/1.19/14.png" alt></p>
<p>一般通常都是用来破解某些东西，自制的话用arduino+cc1101即可。cc1101一般淘宝买的版本呢，中心频率都工作在433mhz，但是并不代表不可以在315工作，cc1101 有各种型号such as ：cc1101 rgpt 这种low power sub -1Ghz。</p>
<h3 id="工的话有这么几种："><a href="#工的话有这么几种：" class="headerlink" title="工的话有这么几种："></a>工的话有这么几种：</h3><h4 id="1-嗅探攻击"><a href="#1-嗅探攻击" class="headerlink" title="1.嗅探攻击"></a>1.嗅探攻击</h4><h6 id="嗅探到遥控器发射的-信号，再重放出去。"><a href="#嗅探到遥控器发射的-信号，再重放出去。" class="headerlink" title="嗅探到遥控器发射的 信号，再重放出去。"></a>嗅探到遥控器发射的 信号，再重放出去。</h6><h4 id="2-嗅探地址码"><a href="#2-嗅探地址码" class="headerlink" title="2.嗅探地址码"></a>2.嗅探地址码</h4><h6 id="因为地址码确定之后，数据码一般来说只有4种可能：1000-0100-0010-0001。such-as：通过嗅探一串锁车代码就能知道其他开车功能了。"><a href="#因为地址码确定之后，数据码一般来说只有4种可能：1000-0100-0010-0001。such-as：通过嗅探一串锁车代码就能知道其他开车功能了。" class="headerlink" title="因为地址码确定之后，数据码一般来说只有4种可能：1000,0100,0010,0001。such as：通过嗅探一串锁车代码就能知道其他开车功能了。"></a>因为地址码确定之后，数据码一般来说只有4种可能：1000,0100,0010,0001。such as：通过嗅探一串锁车代码就能知道其他开车功能了。</h6><h4 id="3-嗅探攻击"><a href="#3-嗅探攻击" class="headerlink" title="3.嗅探攻击"></a>3.嗅探攻击</h4><h6 id="暴力破解去枚举地址码。"><a href="#暴力破解去枚举地址码。" class="headerlink" title="暴力破解去枚举地址码。"></a>暴力破解去枚举地址码。</h6><h4 id="cc1101-arduino我不会"><a href="#cc1101-arduino我不会" class="headerlink" title="cc1101+arduino我不会"></a>cc1101+arduino我不会</h4><h3 id="用的arduino-超再生模块，RCswitch-h库实现"><a href="#用的arduino-超再生模块，RCswitch-h库实现" class="headerlink" title="用的arduino+超再生模块，RCswitch.h库实现"></a>用的arduino+超再生模块，RCswitch.h库实现</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;RCSwitch.h&gt;</span><br><span class="line"></span><br><span class="line">RCSwitch mySwitch = RCSwitch();</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line">  Serial.begin(9600);</span><br><span class="line">  mySwitch.enableTransmit(9);    // 定义发送模块的数据传输针脚</span><br><span class="line">  mySwitch.setPulseLength(170);   // 定义脉冲长度，这个值具体看你使用的遥控器而定</span><br><span class="line">&#125;</span><br><span class="line">void loop() </span><br><span class="line">&#123;</span><br><span class="line">      mySwitch.send(&quot;101111010010110011001&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以输出，but没有电动车去做实验。</p>
<p>。。。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://devil0x.github.io/2019/06/20/SYC第二次面试报告/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="devil0x">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devil0x菜鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/SYC第二次面试报告/" itemprop="url">SYC第二次面试报告</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T03:26:52+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>​                                          </p>
<p>此次第二次面试研究的课题是关于水卡数据的破解以及badusb的wifi版的制作。</p>
<h1 id="1-初学RFID-三中心-13-14-15-16-17栋-水卡的破解研究"><a href="#1-初学RFID-三中心-13-14-15-16-17栋-水卡的破解研究" class="headerlink" title="1. 初学RFID-三中心(13.14.15.16.17栋)水卡的破解研究"></a>1. 初学RFID-三中心(13.14.15.16.17栋)水卡的破解研究</h1><h4 id="1-基本知识："><a href="#1-基本知识：" class="headerlink" title="1.基本知识："></a>1.基本知识：</h4><p>Mifare Classic card提供1k-4k的容量，我们经常见到的是Mifare Classic 1k(S50)，也就是所谓的M1卡。M1卡有从0到15共16个扇区，每个扇区配备了从0到3共块个段，每个段分为b0到b15共16个区块，并且可以保存16字节的内容。 </p>
<p>每个扇区的第4段呢是用来保存KeyA，KeyB和控制位的，每张卡的0扇区还有一个唯一标识的UID号。</p>
<p><strong>破解原理</strong></p>
<p>这种卡类的攻击方式大概分为这么几种：</p>
<p><strong>1</strong>）暴力破解</p>
<p>爆破对于M1卡的破解来说比较有效，因为M1卡是被动卡，需要读卡器来供能，切断供能后卡的临时数据就丢失了，也就是说不会存在输入过多错误密码后造成的锁死之类的情况</p>
<p>FFFFFFFFFFFF、A0B0C0D0E0F0等等都是M1白卡的默认密码，所以当我们使用acr122u的配套软件M1卡服务程序这样的工具来爆破的时候基本上都是用这些默认密码来填充剩余扇区的密码。</p>
<p><strong>2</strong>）克隆卡片（卡复制）</p>
<p>M1卡的扇区可以保存数据，所以大部分的卡片会选择加密扇区后保存数据，我们可以用 uid卡来进行复制，每张M1卡在0扇区第1段都有一个唯一标识，而且是保护无法修改的，uid 卡就是没有设定0扇区保护的卡，所以你可以随意的修改你想要的uid，这样我们就可以克隆出一张连uid都相同的卡片了。</p>
<p><strong>3</strong>）嗅探攻击</p>
<p>在卡和机器数据交换的时候嗅探数据，进行攻击，利用XOR算key工具就可以把扇区的密钥计算出来。（后期可在安卓端用app：M Tools进行数据的嗅探） </p>
<h4 id="2-所需工具"><a href="#2-所需工具" class="headerlink" title="2. 所需工具:"></a>2. 所需工具:</h4><p>硬件： ACR122u</p>
<p>软件：m1卡程序，fixdump，sublime Text3，UID写卡程序</p>
<p>以及安卓端：mifare classical tools, M Tools(神器)</p>
<h4 id="4-实际操作："><a href="#4-实际操作：" class="headerlink" title="4 . 实际操作："></a>4 . 实际操作：</h4><p><strong>1.</strong> <strong>首先把acr122u的驱动叽里呱啦的安装好。</strong></p>
<p><strong>2.</strong> <strong>把水卡放置道读卡上，正确识别之后灯会变为黄色。</strong></p>
<p>​           <img src="https://github.com/devil0x/picture/raw/master/11.09/1.png" alt>                                    </p>
<p>3.打开m1服务软件，正确识别机器之后，点击开始破解。</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/2.png" alt="1541320664628"></p>
<ol start="4">
<li>破解完成当即获得一个1kb dump文件，现在可以直接拖进sublime text3。但是因为是linux移植软件，所以直接打开会看到很多扇区是缺东西的，win下操作的时候需要用到一个fixdump的工具来填充剩余部分。</li>
</ol>
<p>5.先把得到的文件，重新命名为一个简单名称（dumpfile1.dump），然后进行修复dump文件。把dumpfile1.dump拖到fixdump所在文件夹，在空白处按住shift，在右击鼠标，点击在此处打开powershell，然后输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\fixdump dumpfile1.dump</span><br></pre></td></tr></table></figure>
<p>6.获得4kb的dump文件。<img src="https://github.com/devil0x/picture/raw/master/11.09/3.png" alt="1541320780834"></p>
<p>   6.为了容易看出金额差别，用手机端app：mifare打开m1卡，</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/4.png" alt="1541321412959"></p>
<p>会发现没有3号4号扇区的key，</p>
<p>用sublime打开dumpfile1.dump</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/5.png" alt="1541321526563"></p>
<p>每个扇区的第4块区域，前半部为keyA 后半为keyB</p>
<p>直接导入mifare 工具，手机端图形界面好观察一些。</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/6.png" alt="1541321645940"></p>
<p>直接可以看到改扇区的信息了，然后在读卡器记下现在的金额，并命名一下啊，再去刷卡处，打开机器，然后金额开始变化，再记录下金额，用dump对比工具对比。</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/7.png" alt="1541322018408"></p>
<p>随即就发现了一些端倪。这几个数值出现了变化，</p>
<p><strong>E4 12</strong>     <strong>DC 90</strong></p>
<p><strong>E8 12</strong>     <strong>DB 93</strong></p>
<p>把前两部分导进进制转换器</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/8.png" alt="1541322421194"></p>
<p>刚好是金额位，那么剩下的就是。。。。校验位。</p>
<p>这都8102年了，之前经常逛酷安，知道一款神器，M Tools</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/9.png" alt="1541323524737"></p>
<p>这是一款酷安基佬开发的app，最神奇的是作者录制了视频教程，但是地址确是在油管，并附有中式英语进行讲解。现在还有一款app是M Keys也是该作者的作品，这两款app现在也都支持外置ACR122U了，so没有nfc的手机也可以外置进行操作。</p>
<p>这个app也需要提前把密钥导进去，然后就可以对扇区数据进行操作</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/10.png" alt="1541323809934"></p>
<p>这货可以预置常用的算法，什么十六进制倒序，倍数转换啊，直接一点即可。</p>
<p>然后就找到之前发现的金额位数据，直接就可以转换成47.40，然后下一不是选择校验位的算法，but真的看不出有何端倪，直接先跳过了。。。。</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/10.png" alt="1541324006788"></p>
<p>然后来到这个app的核心功能地方，嗅探校验位算法。于是，在刷卡机器旁边，冲冲放放这样来了十几个来回，嗅探到了一下数据。</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/11.png" alt="1541324174499"></p>
<p>目前已知的校验位计算方法有这么几种：</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/12.png" alt="1541324519138"></p>
<p>这里提供一个异或算法工具：在线BCC校验工具（<a href="http://www.ip33.com/bcc.html）" target="_blank" rel="noopener">http://www.ip33.com/bcc.html）</a></p>
<p>反正就是加减乘除，异或取反，各种操作挨个试，</p>
<p>虽说如此，还是看不出来</p>
<p>but 看了好久没看出来，就去翻着去看了几篇教程，发现了一些端倪。</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/13.png" alt="1541326346471"></p>
<p>但就是这个b12部分一直啥都看不出来，真的是毫无规律可循。但其他部分应该还是很好知道规律的</p>
<p>such as：第2块与第1块做对比，金额位b0差-4，b1没有差别，b12差+1, b15差-3，刚好钱差0.04</p>
<p>​          同理第3与第4块的做对比，金额位b0差-8，b1没有差别，b12差+1, b15差-7，刚好钱差0.08</p>
<p>那么可知，凑一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> b0 + b1 + b12-b15 = 某定值</span><br><span class="line">(-4)+(0) +(+1)-(-3)</span><br></pre></td></tr></table></figure>
<p>的话总值是没有变化的没有变化。</p>
<p>把这些数换到10进制计算出这个某定值为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">88(hex)+12(hex)+8(hex)-60(hex) = 66(十进制)</span><br></pre></td></tr></table></figure>
<p>所以b15的公式就是：b15=b0+b1+b12-66</p>
<p>把公式填进M Tools，直接成功完成验证：<img src="https://github.com/devil0x/picture/raw/master/11.09/14.png" alt="1541327523694"></p>
<p>但是这个b12什么鬼，什么规律都没有。。。。。。。。</p>
<p>但后来经过自己观察，这个可能是随机的，从图上可知每刷一次都递增一下，从00开始，such as：08.09.0A。。。。。。</p>
<p>跳过此步骤，自己开始修改数据，比如39.42，先x100，再用16进制表示3942，再倒置一下：</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/15.png" alt="1541327857383"></p>
<p>只有3个数字，空余位用0替补，验证一下<img src="https://github.com/devil0x/picture/raw/master/11.09/16.png" alt="1541327929322"></p>
<p>欧克了，那就是金额位就是66 0f，b12既然是随机的就不用管了随便填00都可以，公式再通过算出b15等于15，填上去，再用读卡器acr122u写入到一张空白的uid卡里边，完毕了。</p>
<p>这都8102年了，提供一个更快的思路，直接用M Tools</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/17.png" alt="1541328695589"></p>
<p>直接交给手机来吧，都不用写个c来计算了。直接充值了</p>
<p>上图<img src="https://github.com/devil0x/picture/raw/master/11.09/18.png" alt="1541328814663"></p>
<h1 id="2-wifi版badusb"><a href="#2-wifi版badusb" class="headerlink" title="2 . wifi版badusb"></a>2 . wifi版badusb</h1><p>BadUSB是今年计算机安全领域的热门话题之一，该漏洞由Karsten Nohl和Jakob Lell共同发现，并在今年的BlackHat安全大会上公布。BadUSB号称是世界上最邪恶的USB外设。</p>
<p>笔者使用他们的代码做了个类似的U盘，用户插入U盘，就会自动执行预置在固件中的恶意代码，下载服务器上恶意文件，执行恶意操作。</p>
<p>但是今天制作的东西是wifi版的badusb。可以wifi上传脚本，执行脚本，在线编辑脚本的bad USB。对了，那个九块钱的Digispark能做到这一切，不可能的，毕竟那货都不能免驱动，那还玩个ball啊……</p>
<h3 id="所需材料："><a href="#所需材料：" class="headerlink" title="所需材料："></a>所需材料：</h3><p>四根线</p>
<p>一块esp8266</p>
<p>一块CJMCU（atnniy85 芯片就行）</p>
<p>esp8266固件（<a href="https://github.com/spacehuhn/wifi_ducky/releases）" target="_blank" rel="noopener">https://github.com/spacehuhn/wifi_ducky/releases）</a></p>
<p>mjmcu 固件（<a href="https://github.com/spacehuhn/wifi_ducky/blob/master/arduino_wifi_duck/arduino_wifi_duck.ino）" target="_blank" rel="noopener">https://github.com/spacehuhn/wifi_ducky/blob/master/arduino_wifi_duck/arduino_wifi_duck.ino）</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;Keyboard.h&gt;</span><br><span class="line">#define BAUD_RATE 57200</span><br><span class="line"></span><br><span class="line">#define ExternSerial Serial1</span><br><span class="line"></span><br><span class="line">String bufferStr = &quot;&quot;;</span><br><span class="line">String last = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">int defaultDelay = 0;</span><br><span class="line"></span><br><span class="line">void Line(String _line)</span><br><span class="line">&#123;</span><br><span class="line">  int firstSpace = _line.indexOf(&quot; &quot;);</span><br><span class="line">  if(firstSpace == -1) Press(_line);</span><br><span class="line">  else if(_line.substring(0,firstSpace) == &quot;STRING&quot;)&#123;</span><br><span class="line">    for(int i=firstSpace+1;i&lt;_line.length();i++) Keyboard.write(_line[i]);</span><br><span class="line">  &#125;</span><br><span class="line">  else if(_line.substring(0,firstSpace) == &quot;DELAY&quot;)&#123;</span><br><span class="line">    int delaytime = _line.substring(firstSpace + 1).toInt();</span><br><span class="line">    delay(delaytime);</span><br><span class="line">  &#125;</span><br><span class="line">  else if(_line.substring(0,firstSpace) == &quot;DEFAULTDELAY&quot;) defaultDelay = _line.substring(firstSpace + 1).toInt();</span><br><span class="line">  else if(_line.substring(0,firstSpace) == &quot;REM&quot;)&#123;&#125; //nothing :/</span><br><span class="line">  else if(_line.substring(0,firstSpace) == &quot;REPLAY&quot;) &#123;</span><br><span class="line">    int replaynum = _line.substring(firstSpace + 1).toInt();</span><br><span class="line">    while(replaynum)</span><br><span class="line">    &#123;</span><br><span class="line">      Line(last);</span><br><span class="line">      --replaynum;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; else&#123;</span><br><span class="line">      String remain = _line;</span><br><span class="line"></span><br><span class="line">      while(remain.length() &gt; 0)&#123;</span><br><span class="line">        int latest_space = remain.indexOf(&quot; &quot;);</span><br><span class="line">        if (latest_space == -1)&#123;</span><br><span class="line">          Press(remain);</span><br><span class="line">          remain = &quot;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">          Press(remain.substring(0, latest_space));</span><br><span class="line">          remain = remain.substring(latest_space + 1);</span><br><span class="line">        &#125;</span><br><span class="line">        delay(5);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Keyboard.releaseAll();</span><br><span class="line">  delay(defaultDelay);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">void Press(String b)&#123;</span><br><span class="line">  if(b.length() == 1) Keyboard.press(char(b[0]));</span><br><span class="line">  else if (b.equals(&quot;ENTER&quot;)) Keyboard.press(KEY_RETURN);</span><br><span class="line">  else if (b.equals(&quot;CTRL&quot;)) Keyboard.press(KEY_LEFT_CTRL);</span><br><span class="line">  else if (b.equals(&quot;SHIFT&quot;)) Keyboard.press(KEY_LEFT_SHIFT);</span><br><span class="line">  else if (b.equals(&quot;ALT&quot;)) Keyboard.press(KEY_LEFT_ALT);</span><br><span class="line">  else if (b.equals(&quot;GUI&quot;)) Keyboard.press(KEY_LEFT_GUI);</span><br><span class="line">  else if (b.equals(&quot;UP&quot;) || b.equals(&quot;UPARROW&quot;)) Keyboard.press(KEY_UP_ARROW);</span><br><span class="line">  else if (b.equals(&quot;DOWN&quot;) || b.equals(&quot;DOWNARROW&quot;)) Keyboard.press(KEY_DOWN_ARROW);</span><br><span class="line">  else if (b.equals(&quot;LEFT&quot;) || b.equals(&quot;LEFTARROW&quot;)) Keyboard.press(KEY_LEFT_ARROW);</span><br><span class="line">  else if (b.equals(&quot;RIGHT&quot;) || b.equals(&quot;RIGHTARROW&quot;)) Keyboard.press(KEY_RIGHT_ARROW);</span><br><span class="line">  else if (b.equals(&quot;DELETE&quot;)) Keyboard.press(KEY_DELETE);</span><br><span class="line">  else if (b.equals(&quot;PAGEUP&quot;)) Keyboard.press(KEY_PAGE_UP);</span><br><span class="line">  else if (b.equals(&quot;PAGEDOWN&quot;)) Keyboard.press(KEY_PAGE_DOWN);</span><br><span class="line">  else if (b.equals(&quot;HOME&quot;)) Keyboard.press(KEY_HOME);</span><br><span class="line">  else if (b.equals(&quot;ESC&quot;)) Keyboard.press(KEY_ESC);</span><br><span class="line">  else if (b.equals(&quot;BACKSPACE&quot;)) Keyboard.press(KEY_BACKSPACE);</span><br><span class="line">  else if (b.equals(&quot;INSERT&quot;)) Keyboard.press(KEY_INSERT);</span><br><span class="line">  else if (b.equals(&quot;TAB&quot;)) Keyboard.press(KEY_TAB);</span><br><span class="line">  else if (b.equals(&quot;END&quot;)) Keyboard.press(KEY_END);</span><br><span class="line">  else if (b.equals(&quot;CAPSLOCK&quot;)) Keyboard.press(KEY_CAPS_LOCK);</span><br><span class="line">  else if (b.equals(&quot;F1&quot;)) Keyboard.press(KEY_F1);</span><br><span class="line">  else if (b.equals(&quot;F2&quot;)) Keyboard.press(KEY_F2);</span><br><span class="line">  else if (b.equals(&quot;F3&quot;)) Keyboard.press(KEY_F3);</span><br><span class="line">  else if (b.equals(&quot;F4&quot;)) Keyboard.press(KEY_F4);</span><br><span class="line">  else if (b.equals(&quot;F5&quot;)) Keyboard.press(KEY_F5);</span><br><span class="line">  else if (b.equals(&quot;F6&quot;)) Keyboard.press(KEY_F6);</span><br><span class="line">  else if (b.equals(&quot;F7&quot;)) Keyboard.press(KEY_F7);</span><br><span class="line">  else if (b.equals(&quot;F8&quot;)) Keyboard.press(KEY_F8);</span><br><span class="line">  else if (b.equals(&quot;F9&quot;)) Keyboard.press(KEY_F9);</span><br><span class="line">  else if (b.equals(&quot;F10&quot;)) Keyboard.press(KEY_F10);</span><br><span class="line">  else if (b.equals(&quot;F11&quot;)) Keyboard.press(KEY_F11);</span><br><span class="line">  else if (b.equals(&quot;F12&quot;)) Keyboard.press(KEY_F12);</span><br><span class="line">  else if (b.equals(&quot;SPACE&quot;)) Keyboard.press(&apos; &apos;);</span><br><span class="line">  //else Serial.println(&quot;not found :&apos;&quot;+b+&quot;&apos;(&quot;+String(b.length())+&quot;)&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line">  </span><br><span class="line">  Serial.begin(BAUD_RATE);</span><br><span class="line">  ExternSerial.begin(BAUD_RATE);</span><br><span class="line"></span><br><span class="line">  pinMode(13,OUTPUT);</span><br><span class="line">  digitalWrite(13,HIGH);</span><br><span class="line"></span><br><span class="line">  Keyboard.begin();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line">  if(ExternSerial.available()) &#123;</span><br><span class="line">    bufferStr = ExternSerial.readStringUntil(&quot;END&quot;);</span><br><span class="line">    Serial.println(bufferStr);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  if(bufferStr.length() &gt; 0)&#123;</span><br><span class="line">    </span><br><span class="line">    bufferStr.replace(&quot;\r&quot;,&quot;\n&quot;);</span><br><span class="line">    bufferStr.replace(&quot;\n\n&quot;,&quot;\n&quot;);</span><br><span class="line">    </span><br><span class="line">    while(bufferStr.length() &gt; 0)&#123;</span><br><span class="line">      int latest_return = bufferStr.indexOf(&quot;\n&quot;);</span><br><span class="line">      if(latest_return == -1)&#123;</span><br><span class="line">        Serial.println(&quot;run: &quot;+bufferStr);</span><br><span class="line">        Line(bufferStr);</span><br><span class="line">        bufferStr = &quot;&quot;;</span><br><span class="line">      &#125; else&#123;</span><br><span class="line">        Serial.println(&quot;run: &apos;&quot;+bufferStr.substring(0, latest_return)+&quot;&apos;&quot;);</span><br><span class="line">        Line(bufferStr.substring(0, latest_return));</span><br><span class="line">        last=bufferStr.substring(0, latest_return);</span><br><span class="line">        bufferStr = bufferStr.substring(latest_return + 1);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    bufferStr = &quot;&quot;;</span><br><span class="line">    ExternSerial.write(0x99);</span><br><span class="line">    Serial.println(&quot;done&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/19.png" alt="1541329587154"></p>
<p>然后rx.tx互相反接，vcc，gnd直接连。焊接就完事儿了</p>
<p>后台登陆一下192.168.4.1</p>
<p>然后程序的话直接</p>
<p>有几个命令</p>
<p>DELAY 延时</p>
<p>GUI r组合键</p>
<p>STRING ….输入字符串</p>
<p>ENTER回车</p>
<p>REM  指不在屏幕上显示东西</p>
<p>几个简单的模拟键盘按键</p>
<p>以及一些payloads源码（<a href="https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payloads）" target="_blank" rel="noopener">https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payloads）</a></p>
<h4 id="2-进阶玩法"><a href="#2-进阶玩法" class="headerlink" title="2. 进阶玩法"></a>2. 进阶玩法</h4><p>希望研究一下，badusb 配合 msf进行免杀脚本的玩法。</p>
<p>挖个坑（<a href="https://www.cnblogs.com/h2zZhou/p/6691875.html），以后填上。" target="_blank" rel="noopener">https://www.cnblogs.com/h2zZhou/p/6691875.html），以后填上。</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://devil0x.github.io/2019/06/20/SYC第三次面试报告/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="devil0x">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devil0x菜鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/SYC第三次面试报告/" itemprop="url">SYC第三次面试报告</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T03:26:52+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="0x01-基础简介"><a href="#0x01-基础简介" class="headerlink" title="0x01.基础简介"></a>0x01.基础简介</h1><h2 id="1-实验设备："><a href="#1-实验设备：" class="headerlink" title="1.实验设备："></a>1.实验设备：</h2><p>kali，安卓手机，咕咕机(GT1), 蓝牙适配器（没有就用电脑自带的hci0）</p>
<h2 id="2-剧情介绍"><a href="#2-剧情介绍" class="headerlink" title="2.剧情介绍"></a>2.剧情介绍</h2><p>在蓝牙开发中，尤其是咕咕机GT1这种只有蓝牙的型号（咕咕机有些机器可以连接wifi），基本上都是手机App与设备间的通信。手机向设备发送数据，然后等待设备的响应。但当数据发出去的时候，却不能确保设备能否准确的响应。设备属于硬件端，一般不受软件端开发人员控制，除非能和硬件端开发人员一起联调，否则很难调试。但在部分Android手机为开发人员提供了保存蓝牙日志的选项，即可保存手机向设备发送的数据和设备响应的数据。 这个log记录了host与controller通信的全部内容，列出了蓝牙协议栈的各个层的消息通信图谱。注意，由于这个log是协议栈自己生成的，它只列出了协议栈发出去的和接收到的消息，若是由于其它原因，例如UART 驱动丢包等导致的问题，则需要使用其它的log工具来寻找原因（例如uart sniffer）。 不再详述snoop log文件本身的格式。知道了这些格式，其实我们可以用wireshark和fte的capture file viewer都可以用来查看btsnoop log。 在此我把两个都给安装了，感觉wireshark鲨鱼鳍更好用一些。。。。。</p>
<p><strong>3.</strong> 首先打开wireshark是一脸蒙蔽的，首先去百度一下关于蓝牙各种协议方面的东西，大概知道每个类型的包都代表啥意思。</p>
<p>１.Hci主机控制器接口，蓝牙协议栈的重要部分，HCI Packet 在 Host 和 Control 之间进行传输，通常有三种类型 Command，Event，Data (ACL 和 SCO/eSCO)。其中 Data 是双向的, Command 只能从 Host 发往 Control, Event 始终是 Control 发向 Host 的。在本文中这点只需要了解即可。</p>
<p>２．GAP—通用访问配置文件(GernericAccess Profile) ,它的作用是发现新的BLE设备.简单一句话，你的新蓝牙设备应该被其它的设备或应用发现，这样才可以连接它。这一部分的工作主要就是由GAP完成。</p>
<ol start="3">
<li><p>ATT – 属性协议（AttributeProtocol）,总而言之，如果我们想连接web 服务器，我们必须使用HTTP协议，HTTP连接了浏览器和服务器。可以类比，应用和蓝牙智能灯泡的连接就是ATT协议控制。</p>
</li>
<li><p>GATT -通用属性配置文件(GenericAttribute Profile)。类比，我们使用浏览器与服务器交互，因此，浏览器负责交换整个数据。GATT也扮演了同样的角色。它负责在智能蓝牙灯泡和移动应用之间交换和展示整个信息。GATT只会在两个设备连接之后才会起作用。</p>
</li>
</ol>
<p>​                                                  </p>
<p><strong>4.</strong>指定方案</p>
<p>1.手机app与机器互联，在app中操做各种功能，并开启蓝牙hci调试日志进行抓包。</p>
<p>2.用wireshark分析流量</p>
<p>3使用kali工具重放包定位到数据位置</p>
<p>4.读取数据包中含义</p>
<p>5.读懂校验码，打印自己的数据</p>
<p><strong>5.实际操作</strong></p>
<p>先进行抓包工作，上来就遇到一个坑，本来用的是一款nexus7平板，开启蓝牙，然后抓包</p>
<p>，但是打开之后，发现连个ball都没有。。。</p>
<p>在这里先排雷，有些设备是抓不到的东西的，如何辨别就是打开日志文件之后查看该文件，附近除了btsnoop_hci.log之外啥都没有的话，那么肯定就是没有抓到东西了。。。。</p>
<p>后来换回主力机进行抓包，MIUI系统有个比较方便的方法，先在拨号盘界面输入<em>#</em>#5959#<em>#</em>开始抓包，然后开始在咕咕机app进行操作，然后再输入<em>#</em>#5959#<em>#</em>结束抓包。这种方法抓到的包比较及时，东西比较干净，我也是踩了很多雷之后发现的。</p>
<p>2.导入到wireshar进行数据分析。</p>
<p>上文已经说过了，里面充斥的hci包就不用看了</p>
<p>之前为了熟悉整个流程，就先参考网上的文章，先实验了一下比较简单的小米手环1.(<a href="https://mp.weixin.qq.com/s/2-g0eFGi0G544URtEvYVtw?client=tim&amp;ADUIN=1442661932&amp;ADSESSION=1542277639&amp;ADTAG=CLIENT.QQ.5591_.0&amp;ADPUBNO=26867" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/2-g0eFGi0G544URtEvYVtw?client=tim&amp;ADUIN=1442661932&amp;ADSESSION=1542277639&amp;ADTAG=CLIENT.QQ.5591_.0&amp;ADPUBNO=26867</a>)</p>
<p>熟悉了一下hcitool和gatttool两个工具。</p>
<p> 开启hciconfig过程中遇到这个问题：错误：Can’t init device hci0: Operation not possible due to RF-kill (132)。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">解决方法：</span><br><span class="line">rfkill unblock all</span><br><span class="line">或者</span><br><span class="line">rfkill list all</span><br></pre></td></tr></table></figure>
<p>依照该文章教程，成功复现之后开始查看这台咕咕机GT1.一开局就陷入找att数据包的误区，还说由于基本协议没看清。因为咕咕机是传统蓝牙4.0而手环是蓝牙4.0 ble。</p>
<p>知道看到这个</p>
<p>不应该死盯着btatt不放的。</p>
<p>于是在wireshark筛选spp数据包</p>
<p>果然瞬间清晰了很多</p>
<p>然后挨个看每个包中的内容，慢慢的发现了一些规律</p>
<p>根据操作小米手环的经验，多进行几次重复操作，容易看出一些明显的变化规律。Such as这个咕咕机有一个指示灯，可以在app里控制开关，多进行几下操作。在录制的log文件中查看，会总有那么几个数据反复出现，，，，，基本可以认为这个maybe就是你发送的命令</p>
<p>​    </p>
<p>然后查找一下这段数据的写入handle，然后就可以进行重放攻击了</p>
<p>所以就往0x0003写入该数据就应该可以实现了。</p>
<p>打开kali进行操作一下。</p>
<p>1）先查询自己电脑加载的蓝牙设备</p>
<p>可以看到自带的蓝牙设备，现在是down关闭状态。</p>
<p>输入hciconfig hci0 up开启设备</p>
<p>然后成功运行，就ojbk了</p>
<p>2.开启蓝牙扫描设备</p>
<p>键入hcitool lescan（用来扫描BLE设备，BT设备也适用），也可以用hcitool scan只能扫描BT设备</p>
<p>3．搜索到目标机器直接用gatttool连接即可</p>
<p>现在我们可以使用 sudo gatttool -I -b device_mac_address 这个命令来连接机器了。</p>
<p>解释下这个命令:</p>
<p>-I          连接接口</p>
<p>-b         识别具体的mac地址</p>
<p>直接输入gatttool -I -b 00:15:83:C3:5E:51，在输入connect连接之</p>
<p>连接成功就变成蓝色</p>
<p>4.输入primary查看咕咕机提供的服务</p>
<p>输入characteristics查询设备特征</p>
<p>句柄 每一个服务和特征都有一个独一无二的部分叫做句柄。句柄是确认一个服务或特征的基本标识。因此，每个服务与特征都必须使用句柄。同时，如果我们想改变任何一个特征的值，我们必须首先确定它的句柄。</p>
<p>5.先进行重放攻击</p>
<p>开灯</p>
<p>关灯</p>
<p>成功找到数据包。重放攻击成功施行</p>
<p>\6. 证明可以成功实施之后，然后查看其他数据包</p>
<p>数据长度为102的spp数据包都是时间以及一个横线</p>
<p>可以发现时间的规律</p>
<p>在查看多个相同数据可以看出一下变化</p>
<p>可知前半部为时间码，为啥为校验码</p>
<p>直接修改时间无法打印，研究一下校验码规律</p>
<p>经过几次计算校验码的规律，直接看出规律。</p>
<p>最简单的加减差值为一定值，年月时分秒每一位变化变化前后加减之后为定值。</p>
<p>根据另一组数据解出该定值位283</p>
<p>公式为：校验位=283-年-月-日-时-分-秒-毫</p>
<p>验算一下</p>
<p>结果是对的，导入机器可以成功写入数据，</p>
<p>。</p>
<p>再看传输部分的地方</p>
<p>经过反复重放</p>
<p>确定一下数据包位置</p>
<p>经过验证这些</p>
<p>可以使用</p>
<p>然后就是以下结果</p>
<p>东西都可以打印，除了数据包部分。。。。。</p>
<p>感觉这一切都无用功了。</p>
<p>根据原理应该是把要打印图像，每层次切片</p>
<p>一层一层的打印</p>
<p>尽力而为，现在只能到这部分了。。。。。。</p>
<p>有时间把数据包可以搞清楚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://devil0x.github.io/2019/06/20/gsm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="devil0x">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devil0x菜鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/gsm/" itemprop="url">gsm</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T03:26:52+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="0x01-先安装依赖"><a href="#0x01-先安装依赖" class="headerlink" title="0x01.先安装依赖"></a>0x01.先安装依赖</h1><p><strong>0x01.安装编译依赖包</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git cmake libboost-all-dev libcppunit-dev swig doxygen liblog4cpp5-dev python-scipy</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install gnuradio gnuradio-dev rtl-sdr librtlsdr-dev osmo-sdr libosmosdr-dev libosmocore libosmocore-dev cmake libboost-all-dev libcppunit-dev swig doxygen liblog4cpp5-dev python-scipy</span><br></pre></td></tr></table></figure>
<h1 id="0x02-编译安装gr-gsm"><a href="#0x02-编译安装gr-gsm" class="headerlink" title="0x02.编译安装gr-gsm"></a>0x02.编译安装gr-gsm</h1><h4 id="编译gr-gsm老是不通过"><a href="#编译gr-gsm老是不通过" class="headerlink" title="编译gr-gsm老是不通过"></a>编译gr-gsm老是不通过</h4><p>解决方法：先安装gr-osmosdr再编译gr-gsm，秒过</p>
<h4 id="1-安装gr-osmosdr"><a href="#1-安装gr-osmosdr" class="headerlink" title="1.安装gr-osmosdr"></a>1.安装gr-osmosdr</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git clone git://git.osmocom.org/gr-osmosdr</span><br><span class="line">cd gr-osmosdr/</span><br><span class="line">mkdir build</span><br><span class="line">cd build/</span><br><span class="line">cmake ../</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>
<p>要是还有问题的话，看这两个链接：有前辈遇到问题是的解决经验</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://osmocom.org/projects/gr-osmosdr/wiki</span><br><span class="line">https://github.com/ptrkrysik/gr-gsm/issues/431</span><br></pre></td></tr></table></figure>
<h4 id="2-安装gr-gsm"><a href="#2-安装gr-gsm" class="headerlink" title="2. 安装gr-gsm"></a>2. 安装gr-gsm</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/ptrkrysik/gr-gsm.git</span><br><span class="line">cd gr-gsm</span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br></pre></td></tr></table></figure>
<h1 id="0x03-编译kalibrate"><a href="#0x03-编译kalibrate" class="headerlink" title="0x03.编译kalibrate"></a>0x03.编译kalibrate</h1><p>HackRF</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kalibrate-hackrf (kalibrate For HackRF)</span><br><span class="line">git clone https://github.com/scateu/kalibrate-hackrf.git</span><br><span class="line">cd kalibrate-hackrf</span><br><span class="line">./bootstrap</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<p>RTL-SDR 电视棒</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kalibrate-rtl(kalibrate For rtl-sdr)</span><br><span class="line">git clone https://github.com/steve-m/kalibrate-rtl.git</span><br><span class="line">cd kalibrate-rtl</span><br><span class="line">./bootstrap</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>
<h5 id="0x0-0要是遇到问题"><a href="#0x0-0要是遇到问题" class="headerlink" title="0x0.0要是遇到问题:"></a>0x0.0要是遇到问题:</h5><p>先下载，编译和安装 RTL2832U驱动:</p>
<p><strong>注意:</strong> </p>
<ul>
<li><strong>在从 git 上下载和编译新版本的 rtlsdr 之前，如果已经安装了其它版本需要首先运行 “make uninstall”来卸载该版本。</strong></li>
<li><strong>为了能够在 Ubuntu 中以普通用户身份使用电视棒RTL-SDR，需要通过在 cmake 命令后指定参数 “-DINSTALL_UDEV_RULES=ON” 来安装合适的 udev 规则文件。</strong> </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git clone git://git.osmocom.org/rtl-sdr.git</span><br><span class="line">cd rtl-sdr/</span><br><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ../ -DINSTALL_UDEV_RULES=ON</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig</span><br><span class="line">cp ../rtl-sdr.rules /etc/udev/rules.d/</span><br></pre></td></tr></table></figure>
<p>如果遇到内核已开始运行的话</p>
<p>看起来Ubuntu正在自动加载DVB调谐器的内置内核模块。试着跑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rmmod dvb_usb_rtl28xxu</span><br></pre></td></tr></table></figure>
<p>看看能不能用。可以在“/etc/modprobe.d”中创建“rtlsdr.conf”并将下面放入即可生效。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blacklist dvb_usb_rtl28xxu</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://devil0x.github.io/2019/06/20/freebuf第一次/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="devil0x">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devil0x菜鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/freebuf第一次/" itemprop="url">freebuf第一次</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T03:26:52+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="初学RFID"><a href="#初学RFID" class="headerlink" title="初学RFID"></a>初学RFID</h1><h4 id="1-前情提要"><a href="#1-前情提要" class="headerlink" title="1.前情提要"></a>1.前情提要</h4><p>Mifare Classic card提供1k-4k的容量，我们经常见到的是Mifare Classic 1k(S50)，也就是所谓的M1卡。M1卡有从0到15共16个扇区，每个扇区配备了从0到3共块个段，每个段分为b0到b15共16个区块，并且可以保存16字节的内容。</p>
<p>每个扇区的第4段呢是用来保存KeyA，KeyB和控制位的，每张卡的0扇区还有一个唯一标识的UID号。</p>
<p><strong>破解原理</strong></p>
<p>这种卡类的攻击方式大概分为这么几种：</p>
<p><strong>1</strong>）暴力破解</p>
<p>爆破对于M1卡的破解来说比较有效，因为M1卡是被动卡，需要读卡器来供能，切断供能后卡的临时数据就丢失了，也就是说不会存在输入过多错误密码后造成的锁死之类的情况</p>
<p>FFFFFFFFFFFF、A0B0C0D0E0F0等等都是M1白卡的默认密码，所以当我们使用acr122u的配套软件M1卡服务程序这样的工具来爆破的时候基本上都是用这些默认密码来填充剩余扇区的密码。</p>
<p><strong>2</strong>）克隆卡片（卡复制）</p>
<p>M1卡的扇区可以保存数据，所以大部分的卡片会选择加密扇区后保存数据，我们可以用 uid卡来进行复制，每张M1卡在0扇区第1段都有一个唯一标识，而且是保护无法修改的，uid 卡就是没有设定0扇区保护的卡，所以你可以随意的修改你想要的uid，这样我们就可以克隆出一张连uid都相同的卡片了。</p>
<p><strong>3</strong>）嗅探攻击</p>
<p>在卡和机器数据交换的时候嗅探数据，并计算出校验即可。后期可在安卓端用app：M Tools进行数据的嗅探。</p>
<p>已经有很多篇文章讲过了原理部分，直接讲一下阶段</p>
<h4 id="2-所需工具"><a href="#2-所需工具" class="headerlink" title="2. 所需工具:"></a>2. 所需工具:</h4><p>硬件： ACR122u(最常见的rfid设备，本质就是pn532，但是有个足够强的上位机，比pn532容易上手。没买pm3是因为感觉贵，没啥必要。。。)</p>
<p>软件：m1卡程序，fixdump，sublime Text3，UID写卡程序</p>
<p>以及安卓端：mifare classical tools, M Tools(神器)</p>
<p>mifare classical tools是一款让人又爱又恨的软件，但是远远不如M Tools强大得多。。。 </p>
<h4 id="4-实际操作："><a href="#4-实际操作：" class="headerlink" title="4 . 实际操作："></a>4 . 实际操作：</h4><p><strong>1.</strong> <strong>首先把acr122u的驱动叽里呱啦的安装好。</strong></p>
<p><strong>2.</strong> <strong>把水卡放置道读卡上，正确识别之后灯会变为黄色。</strong></p>
<p>3.打开m1服务软件，正确识别机器之后，点击开始破解。</p>
<p><img src="https://image.3001.net/images/20190203/1549195573_5c56d935b9cac.png!small" alt="1.png">破解完成当即获得一个1kb dump文件，现在可以直接拖进sublime text3，即可看出扇区密钥。</p>
<p>6.为了容易看出金额差别，用手机端app：mifare打开m1卡，</p>
<p><img src="https://image.3001.net/images/20190203/1549196895_5c56de5fd60a6.png!small" alt="2.png"><br>会发现没有3号4号扇区的key，</p>
<p>用sublime打开dumpfile1.dump</p>
<p><img src="https://image.3001.net/images/20190203/1549196905_5c56de6974e4e.png!small" alt="3.png"></p>
<p>每个扇区的第4块区域，前半部为keyA 后半为keyB</p>
<p>直接导入mifare 工具，手机端图形界面好观察一些。<img src="https://image.3001.net/images/20190203/1549197158_5c56df66a6331.png!small" alt="4.png"></p>
<p>直接可以看到改扇区的信息了。先把现在的这份数据保存一下，然后再去机器那里刷一下机器，然后就可以看出数据变化位了，后就可以确定数据位和校验位了。</p>
<p><img src="https://image.3001.net/images/20190203/1549197071_5c56df0f42a54.png!small" alt="5.png"></p>
<p>随即就发现了一些端倪。这几个数值出现了变化，</p>
<p><strong>E4 12</strong> <strong>DC 90</strong></p>
<p><strong>E8 12</strong> <strong>DB 93</strong></p>
<p>把前两部分导进进制转换器</p>
<p><img src="https://image.3001.net/images/20190203/1549199067_5c56e6db49ba4.png!small" alt="6.png"></p>
<p>刚好是金额位，那么剩下的就是。。。。校验位。</p>
<p>这都8102年了，之前经常逛酷安，知道一款神器，M Tools</p>
<p><img src="https://github.com/devil0x/picture/raw/master/11.09/9.png" alt="Image"></p>
<p>这是一款酷安基佬开发的app，最神奇的是作者录制了视频教程，但是地址确是在油管，并附有中式英语进行讲解。现在还有一款app是M Keys也是该作者的作品，这两款app现在也都支持外置ACR122U了，so没有nfc的手机也可以外置进行操作。</p>
<p>这个app也需要提前把密钥导进去，然后就可以对扇区数据进行操作</p>
<p><img src="https://image.3001.net/images/20190203/1549201905_5c56f1f1e4074.png!small" alt="10.png"><br>这货可以预置常用的算法，什么十六进制倒序，倍数转换啊，直接一点即可。</p>
<p>然后就找到之前发现的金额位数据，直接就可以转换成47.40，然后下一不是选择校验位的算法，but真的看不出有何端倪，直接先跳过了。然后来到这个app的核心功能，嗅探校验位算法。于是，在刷卡机器旁边，冲冲放放这样来了十几个来回，嗅探到了一下数据。</p>
<p><img src="https://image.3001.net/images/20190203/1549201963_5c56f22b324f4.png!small" alt="11.png">目前已知的校验位计算方法有这么几种：</p>
<p><img src="https://image.3001.net/images/20190203/1549202610_5c56f4b28847c.png!small" alt="12.png"></p>
<p>反正就是加减乘除，异或取反，各种操作挨个试。看了好久没看出来，就去翻着去看了几篇教程，发现了一些端倪。</p>
<p><img src="https://image.3001.net/images/20190203/1549202664_5c56f4e8b808c.png!small" alt="13.png"></p>
<p>但就是这个b12部分一直啥都看不出来，真的是毫无规律可循。但其他部分应该还是很好知道规律的</p>
<p>such as：第2块与第1块做对比，金额位b0差-4，b1没有差别，b12差+1, b15差-3，刚好钱差0.04</p>
<p>同理第3与第4块的做对比，金额位b0差-8，b1没有差别，b12差+1, b15差-7，刚好钱差0.08</p>
<p>那么可知，凑一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> b0 + b1 + b12-b15 = 某定值</span><br><span class="line">(-4)+(0) +(+1)-(-3)</span><br></pre></td></tr></table></figure>
<p>的话总值是没有变化的没有变化。</p>
<p>把这些数换到10进制计算出这个某定值为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">88(hex)+12(hex)+8(hex)-60(hex) = 66(十进制)</span><br></pre></td></tr></table></figure>
<p>所以b15的公式就是：b15=b0+b1+b12-66</p>
<p>把公式填进M Tools，直接成功完成验证：</p>
<p><img src="https://image.3001.net/images/20190203/1549202700_5c56f50c29d24.png!small" alt="14.png"></p>
<p>但是这个b12什么鬼，什么规律都没有。。。。。。。。</p>
<p>但后来经过自己观察，这个可能是随机的，从图上可知每刷一次都递增一下，从00开始，such as：08.09.0A。。。。。。</p>
<p>\5. 修改数据：</p>
<p>到了修改数据的地方，这都8102年了，提供一个更快的思路，直接用M Tools。再充值的地方，长按有个定额的选项，直接填入即可。</p>
<p>然后就修改成功了，改个奇数位试试，<img src="https://image.3001.net/images/20190203/1549202946_5c56f6029ddd2.png!small" alt="18.png"></p>
<h1 id="2-终语。"><a href="#2-终语。" class="headerlink" title="2.终语。"></a>2.终语。</h1><p>这算是遇到一个贼拉简单的校验，甚至连异或检验都没有。经过多次的计算校验，感觉计算校验就一条总结：羊毛出在羊身上。</p>
<p>1.用好winhex，逆向计算器</p>
<p>2.最重要的，校验的奥义：羊毛出在羊身上。就是说，校验位在哪里，你可以通过多看几个数据的变化来看出。而校验的产生，总是遵循金额位的变化，校验不管咋变，都是金额位数值通过各种公式组合加计算出来的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://devil0x.github.io/2019/06/20/python study/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="devil0x">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devil0x菜鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/python study/" itemprop="url">Python入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T03:26:51+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-字符串类型"><a href="#1-字符串类型" class="headerlink" title="1.字符串类型"></a>1.字符串类型</h2><p>打引号是字符串,</p>
<p>‘582’字符串  </p>
<p>582数字</p>
<h2 id="3-列表"><a href="#3-列表" class="headerlink" title="3. 列表"></a>3. 列表</h2><h3 id="1-列表的操作"><a href="#1-列表的操作" class="headerlink" title="1.列表的操作"></a>1.列表的操作</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1.	member.append([&apos;qwe&apos;, &apos;hello&apos;])	#添加成员</span><br><span class="line">	member</span><br><span class="line">	[&apos;hekki &apos;, &apos;hello world&apos;, &apos;qwe&apos;, [&apos;qwe&apos;, &apos;hello&apos;]]</span><br><span class="line">2.	member.extend([&apos;qwe&apos;, &apos;hello&apos;])	#扩充成员</span><br><span class="line">	member</span><br><span class="line">	[&apos;hekki &apos;, &apos;hello world&apos;, &apos;qwe&apos;, [&apos;qwe&apos;, &apos;hello&apos;], &apos;qwe&apos;, &apos;hello&apos;] </span><br><span class="line">3.	member.insert(0, &apos;qwe&apos;)	#把qwe添加到0位置</span><br><span class="line">	member</span><br><span class="line">	[&apos;qwe&apos;, &apos;hekki &apos;, &apos;hello world&apos;, &apos;qwe&apos;, [&apos;qwe&apos;, &apos;hello&apos;], &apos;qwe&apos;, &apos;hello&apos;]</span><br><span class="line">4.	member.remove(&apos;qwe&apos;)	#移除确定的字符</span><br><span class="line">	member</span><br><span class="line">	[&apos;hekki &apos;, &apos;hello world&apos;, &apos;qwe&apos;, [&apos;qwe&apos;, &apos;hello&apos;], &apos;qwe&apos;, &apos;hello&apos;] </span><br><span class="line">5.	del member[1]	#直接删除</span><br><span class="line">	member</span><br><span class="line">	[&apos;hekki &apos;, &apos;qwe&apos;, [&apos;qwe&apos;, &apos;hello&apos;], &apos;qwe&apos;, &apos;hello&apos;]</span><br><span class="line">6.	member.pop()	#删除列表的最后一个,并打印删除的字符</span><br><span class="line">	member.pop(0)</span><br></pre></td></tr></table></figure>
<h3 id="2-列表常用操作符"><a href="#2-列表常用操作符" class="headerlink" title="2. 列表常用操作符"></a>2. 列表常用操作符</h3><p>dir()列举函数</p>
<p>list.count() 统计出现次数 list.count(123, 3, 7)出现次数</p>
<p>sort</p>
<h1 id="0x02-条件and循环"><a href="#0x02-条件and循环" class="headerlink" title="0x02.条件and循环"></a>0x02.条件and循环</h1><h2 id="0x01-条件if"><a href="#0x01-条件if" class="headerlink" title="0x01.条件if"></a>0x01.条件if</h2><p>if  ， elif , else, </p>
<h3 id="1-三元操作符"><a href="#1-三元操作符" class="headerlink" title="1.三元操作符"></a>1.三元操作符</h3><p>语法：x if 条件 else y</p>
<h3 id="2-断言assert"><a href="#2-断言assert" class="headerlink" title="2.断言assert"></a>2.断言assert</h3><p>关键词后的条件为假时，抛出AssertionError；</p>
<p>· 当做一个检查点，确保某个条件必须为真。</p>
<h2 id="0x02-循环"><a href="#0x02-循环" class="headerlink" title="0x02.循环"></a>0x02.循环</h2><h3 id="1-for循环"><a href="#1-for循环" class="headerlink" title="1.for循环"></a>1.for循环</h3><p>结构：</p>
<p>for 目标 in 表达式:<br>    循环体</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; member = [&apos;hello  world&apos;, &apos;529&apos;, &apos;我爱你哦·！！&apos;]</span><br><span class="line">&gt;&gt;&gt; for i in member:</span><br><span class="line">	print(i, len(i))</span><br><span class="line"></span><br><span class="line">hello  world 12</span><br><span class="line">529 3</span><br><span class="line">我爱你哦·！！ 7</span><br></pre></td></tr></table></figure>
<p>len()           字符串长度</p>
<p>range( [start,] stop[, step = 1])<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;range(10)        # 从 0 开始到 10</span><br><span class="line">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span><br><span class="line">&gt;&gt;&gt; range(1, 11)     # 从 1 开始到 11</span><br><span class="line">[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span><br><span class="line">&gt;&gt;&gt; range(0, 30, 5)  # 步长为 5</span><br><span class="line">[0, 5, 10, 15, 20, 25]</span><br><span class="line">&gt;&gt;&gt; range(0, 10, 3)  # 步长为 3</span><br><span class="line">[0, 3, 6, 9]</span><br><span class="line">&gt;&gt;&gt; range(0, -10, -1) # 负数</span><br><span class="line">[0, -1, -2, -3, -4, -5, -6, -7, -8, -9]</span><br><span class="line">&gt;&gt;&gt; range(0)</span><br><span class="line">[]</span><br><span class="line">&gt;&gt;&gt; range(1, 0)</span><br><span class="line">[]</span><br></pre></td></tr></table></figure></p>
<h1 id="0x03-函数"><a href="#0x03-函数" class="headerlink" title="0x03.函数"></a>0x03.函数</h1><p>def myfirst funcation():</p>
<h2 id="2-函数指针"><a href="#2-函数指针" class="headerlink" title="2.函数指针"></a>2.函数指针</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="0x04-爬虫"><a href="#0x04-爬虫" class="headerlink" title="0x04.爬虫"></a>0x04.爬虫</h1><h2 id="1-下载图片"><a href="#1-下载图片" class="headerlink" title="1.下载图片"></a>1.下载图片</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="keyword">import</span> urllib.request</span><br><span class="line">response = urllib.request.urlopen(<span class="string">"http://placekitten.com/g/200/100"</span>)</span><br><span class="line">cat_img = response.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'cat_200_100.jpg'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(cat_img)</span><br></pre></td></tr></table></figure>
<h2 id="2-房价排行"><a href="#2-房价排行" class="headerlink" title="2.房价排行"></a>2.房价排行</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">导入requests</span><br><span class="line">定义open_url，导入user-agent, 返回到res</span><br><span class="line">返回 res</span><br><span class="line"></span><br><span class="line">html解析模块   bs4.BeautifulSoup</span><br><span class="line">bs4.BeautifulSoup</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://devil0x.github.io/2019/06/20/c118 osmocombb/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="devil0x">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devil0x菜鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/c118 osmocombb/" itemprop="url">Ubuntu编译OsmocomBB 环境</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T03:26:51+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="前提准备"><a href="#前提准备" class="headerlink" title="前提准备"></a>前提准备</h1><p>OsmocomBB项目的所有文章都在这个地址 <a href="https://osmocom.org/projects/baseband/wiki" target="_blank" rel="noopener">https://osmocom.org/projects/baseband/wiki </a>，这里详细记录了每一个细节，请自行研读，博主只写了环境搭建的部分。</p>
<p>MS：Mobile Station，移动终端；<br>IMSI：International Mobile Subscriber Identity，国际移动用户标识号，是TD系统分给用户的唯一标识号，它存储在SIM卡、HLR/VLR中，最多由15个数字组成；<br>MCC：Mobile Country Code，是移动用户的国家号，中国是460；<br>MNC：Mobile Network Code ，是移动用户的所属PLMN网号，中国移动为00、02，中国联通为01；<br>MSIN：Mobile Subscriber Identification Number，是移动用户标识；<br>NMSI：National Mobile Subscriber Identification，是在某一国家内MS唯一的识别码；<br>BTS：Base Transceiver Station，基站收发器；<br>BSC：Base Station Controller，基站控制器；<br>MSC：Mobile Switching Center，移动交换中心。移动网络完成呼叫连接、过区切换控制、无线信道管理等功能的设备，同时也是移动网与公用电话交换网(PSTN)、综合业务数字网(ISDN)等固定网的接口设备；<br>HLR：Home location register。保存用户的基本信息，如你的SIM的卡号、手机号码、签约信息等，和动态信息，如当前的位置、是否已经关机等；<br>VLR：Visiting location register，保存的是用户的动态信息和状态信息，以及从HLR下载的用户的签约信息；<br>CCCH：Common Control CHannel，公共控制信道。是一种“一点对多点”的双向控制信道，其用途是在呼叫接续阶段，传输链路连接所需要的控制信令与信息。</p>
<h2 id="0x01-准备c118"><a href="#0x01-准备c118" class="headerlink" title="0x01.准备c118"></a>0x01.准备c118</h2><ul>
<li>MotorolaC123/C121/C118 (E88) — our primary target</li>
<li>MotorolaC140/C139 (E86)</li>
<li>MotorolaC155 (E99) — our secondary target</li>
<li>MotorolaV171 (E68/E69)</li>
<li>SonyEricssonJ100i</li>
<li>Pirelli DP-L10</li>
<li>Neo 1973 (GTA01)</li>
<li>OpenMoko – Neo Freerunner (GTA02)</li>
<li>SciphoneDreamG2 (MT6235 based)<br>我们选择Moto C118，因为官方支持的最好、硬件成本低，￥35/台（手机+电池+充电器）<br><img src="http://www.vuln.cn/wp-content/uploads/drops/20160106/201601061509262473932.jpg" alt="p3"></li>
</ul>
<h2 id="0x02-USB转串口模块"><a href="#0x02-USB转串口模块" class="headerlink" title="0x02. USB转串口模块"></a>0x02. USB转串口模块</h2><p>CH340,CP2102叽里呱啦的都是可以的，能正常识别就行。</p>
<h2 id="0x03-系统要求"><a href="#0x03-系统要求" class="headerlink" title="0x03.系统要求"></a>0x03.系统要求</h2><p>这是我的系统，64位的ubuntu16.0.4，内核版本4.15.0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Linux box 4.15.0-47-generic #50~16.04.1-Ubuntu SMP Fri Mar 15 16:06:21 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux</span><br><span class="line"></span><br><span class="line">No LSB modules are available.</span><br><span class="line">Distributor ID:	Ubuntu</span><br><span class="line">Description:	Ubuntu 16.04.6 LTS</span><br><span class="line">Release:	16.04</span><br><span class="line">Codename:	xenial</span><br></pre></td></tr></table></figure>
<p>我的机器是skywangg@box，所以以下操作都是在/home/skywangg 目录下进行。</p>
<h1 id="2-创建ARM编译环境（armtoolchain）"><a href="#2-创建ARM编译环境（armtoolchain）" class="headerlink" title="2.创建ARM编译环境（armtoolchain）"></a>2.创建ARM编译环境（armtoolchain）</h1><p>OsmocomBB项目是运行在一个移动终端也就是一个手机上面，生成了一个固件并刷入手机，用于控制手机的各种操作并提供一个接口给电脑接收电脑传过去的指令，那么就需要本地电脑有一个用于连接手机的通道，在这里叫做osmocon，制作手机固件需要使用ARM编译环境编译生成最终的.bin文件，所以首先就是搭建这个ARM编译环境。</p>
<p>开始搭建环境之前，我认为你已经准备好了Linux环境并更新到最新版本，创建一个文件夹用来存放ARM编译环境的所需文件，这里假设创建的文件夹为armtoolchain，进入文件夹后下载构建脚本并赋予其可执行权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir armtoolchain</span><br><span class="line">cd armtoolchain</span><br><span class="line">wget https://osmocom.org/attachments/download/2052/gnu-arm-build.3.sh</span><br><span class="line">sudo chmod +x gnu-arm-build.3.sh</span><br></pre></td></tr></table></figure>
<p>接着创建几个文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir build install src</span><br></pre></td></tr></table></figure>
<p>这几个文件夹分别存放了对应的文件，切换到src文件夹下载必要的文件包</p>
<p>注意：这里的下载地址可能很慢或者无法下载，请自行准备好梯子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd src/</span><br><span class="line">wget https://ftp.gnu.org/gnu/gcc/gcc-4.8.2/gcc-4.8.2.tar.bz2</span><br><span class="line">wget https://ftp.gnu.org/gnu/binutils/binutils-2.21.1a.tar.bz2</span><br><span class="line">wget ftp://sources.redhat.com/pub/newlib/newlib-1.19.0.tar.gz</span><br></pre></td></tr></table></figure>
<p>这个时候不要着急构建，先安装一些必须的依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential libgmp3-dev libmpfr-dev libx11-6 libx11-dev texinfo flex bison libncurses5 libncurses5-dbg libncurses5-dev libncursesw5 libncursesw5-dbg libncursesw5-dev zlibc zlib1g-dev libmpfr4 libmpc-dev</span><br></pre></td></tr></table></figure>
<p>然后就可以执行构建脚本了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ..</span><br><span class="line">./gnu-arm-build.3.sh</span><br></pre></td></tr></table></figure>
<p>按任意键开始执行构建，直到出现以下提示信息则构建成功</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Build complete! Add /home/skywnagg/armtoolchain/install/bin to your PATH to make arm-none-eabi-gcc and friends</span><br><span class="line">accessible directly.</span><br></pre></td></tr></table></figure>
<p>根据提示信息把上面的路径添加到环境变量中，环境变量在/home/kbdancer/.bashrc，使用vim编辑然后将下面的这行添加到环境变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:home/skywangg/armtoolchain/install/bin</span><br></pre></td></tr></table></figure>
<p>这里注意把路径改成你自己的，然后执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /home/kbdancer/.bashrc</span><br></pre></td></tr></table></figure>
<p>让环境变量生效，接下来就可以编译osmocombb了。</p>
<h1 id="3-编译osmocombb"><a href="#3-编译osmocombb" class="headerlink" title="3.编译osmocombb"></a>3.编译osmocombb</h1><p>开始之前需要安装一些必要的依赖包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install libtool shtool automake autoconf git-core pkg-config make gcc</span><br></pre></td></tr></table></figure>
<p>这些依赖包是编译必备的软件包，osmocomBB项目是基于libosmocore的，所以要先搞定 libosmocore，libosmocore的编译安装也有一些依赖需要安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential libtool libtalloc-dev shtool autoconf automake git-core pkg-config make gcc</span><br></pre></td></tr></table></figure>
<p>接下来还必须安装一些库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libpcsclite-dev</span><br></pre></td></tr></table></figure>
<p>下面就可以把代码同步下来了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git://git.osmocom.org/libosmocore.git</span><br></pre></td></tr></table></figure>
<p>同步代码之后就可以编译了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd libosmocore/</span><br><span class="line">autoreconf -i</span><br><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig -i</span><br><span class="line">cd ..</span><br></pre></td></tr></table></figure>
<p>编译安装完libosmocore就可以继续编译osmocombb了，首先同步最新代码（注意：请自备梯子）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone git://git.osmocom.org/osmocom-bb.git</span><br><span class="line">cd osmocom-bb</span><br><span class="line">git pull --rebase</span><br></pre></td></tr></table></figure>
<p>代码拉取回来之后执行编译</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd src</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p>遇到这些缺乏某些依赖的，根据报错，百度。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">No package &apos;libpcsclite&apos; found</span><br><span class="line">No package &apos;gnutls&apos; found</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/devil0x/picture/raw/master/5.14/3.png" alt></p>
<p>如果遇到红字这种(这张图片转载自安全客：<a href="https://www.anquanke.com/post/id/84627，当时我忘记截图了。)都是OsmocomBB交叉编译环境出现问题，因为网上很多文章说一半不说一半导致" target="_blank" rel="noopener">https://www.anquanke.com/post/id/84627，当时我忘记截图了。)都是OsmocomBB交叉编译环境出现问题，因为网上很多文章说一半不说一半导致</a> 没安装好标题二里面的环境包又或者你的环境包下载错了。这时候重新指向一下gcc编译环境目录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/home/skywangg/armtoolchain/install/bin:$PATH</span><br><span class="line">实际路径根据你的机器来操作。</span><br></pre></td></tr></table></figure>
<p>再有其他报错，就先复制报错第一天，复制粘贴搜索解决方法。</p>
<p>这篇文章有详细的改错方法:<a href="https://www.anquanke.com/post/id/84627" target="_blank" rel="noopener">https://www.anquanke.com/post/id/84627</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">修改问题文件（如果你是gnu-arm-build.2.sh并且没有出现cell扫描不动的问题，请跳过这一步）</span><br><span class="line"></span><br><span class="line">进入osmocom-bb找到这些文件并修改他们            </span><br><span class="line">vi osmocom-bb/src/target/firmware/board/compal/highram.lds</span><br><span class="line">vi osmocom-bb/src/target/firmware/board/compal/ram.lds</span><br><span class="line">vi osmocom-bb/src/target/firmware/board/compal_e88/flash.lds</span><br><span class="line">vi osmocom-bb/src/target/firmware/board/compal_e88/loader.lds</span><br><span class="line">vi osmocom-bb/src/target/firmware/board/mediatek/ram.lds</span><br><span class="line"></span><br><span class="line">找到里面的这一串代码            </span><br><span class="line"></span><br><span class="line">KEEP(*(SORT(.ctors)))</span><br><span class="line">在下面加入</span><br><span class="line">KEEP(*(SORT(.init_array)))  </span><br><span class="line"></span><br><span class="line">保存即可，全部修改好，在进入osmocom-bb/src重新编译一下</span><br><span class="line"></span><br><span class="line">$ make -e CROSS_TOOL_PREFIX=arm-none-eabi-</span><br></pre></td></tr></table></figure>
<h1 id="4-实战操作"><a href="#4-实战操作" class="headerlink" title="4.实战操作"></a>4.实战操作</h1><p>先用ttl转usb连接c118手机，插入usb孔</p>
<p><img src="https://github.com/devil0x/picture/raw/master/5.14/1.jpg" alt></p>
<p>lsusb   //查看是否插入成功</p>
<p><img src="https://github.com/devil0x/picture/raw/master/5.14/4.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /home/skywangg/osmocombb/osmocom-bb/src/host/osmocon/ </span><br><span class="line">//cd进osmocombb目录</span><br><span class="line"></span><br><span class="line">sudo ./osmocon -m c123xor -p /dev/ttyUSB0 ../../target/firmware/board/compal_e88/layer1.compalram.bin</span><br><span class="line">//键入该底下的命令</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/devil0x/picture/raw/master/5.14/5.png" alt></p>
<p>按一下开机键（短按，不是长按）</p>
<p>有时候停了 就按一下开机键（我有时候需要按几次才完全写入的）</p>
<p><img src="https://github.com/devil0x/picture/raw/master/5.14/6.png" alt></p>
<p>看到这里就写入成功了。手机上也出现 layer 1 osmocom bb</p>
<p><img src="https://github.com/devil0x/picture/raw/master/5.14/7.jpg" alt></p>
<p><strong>六.打开新终端输入</strong></p>
<p>新建一个终端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /home/skywangg/osmocombb/osmocom-bb/src/host/layer23/src/misc </span><br><span class="line">//cd进osmocombb目录</span><br><span class="line"></span><br><span class="line">sudo ./cell_log -O  </span><br><span class="line">//搜索附近伪基站</span><br></pre></td></tr></table></figure>
<p><img src="https://github.com/devil0x/picture/raw/master/5.14/8.png" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd /home/skywangg/osmocombb/osmocom-bb/src/host/layer23/src/misc </span><br><span class="line">//cd进osmocombb下的目录</span><br><span class="line"></span><br><span class="line">sudo ./ccch_scan -i 127.0.0.1 -a ARFCN</span><br><span class="line">//刚刚搜索附近的伪基站 </span><br><span class="line"></span><br><span class="line">sudo ./ccch_scan -i 127.0.0.1 -a 46</span><br></pre></td></tr></table></figure>
<p>D终端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo wireshark -k -i lo   </span><br><span class="line">//打开wireshark并开始，立即抓包</span><br></pre></td></tr></table></figure>
<p>选gsm_sms即可</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://devil0x.github.io/2019/06/20/bladerf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="devil0x">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devil0x菜鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/bladerf/" itemprop="url">blaedrf入门学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T03:26:51+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>bladerf入门学习</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">add-apt-repository ppa:bladerf/bladerf</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install bladerf</span><br><span class="line">sudo apt -get install libbladerf-dev</span><br><span class="line">sudo apt-get install bladerf-firmware-fx3</span><br><span class="line">sudo apt-get install bladerf-fpga-hos tedx40</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://devil0x.github.io/2019/06/20/51学习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="devil0x">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="devil0x菜鸟">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/20/51学习/" itemprop="url">51单片机学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-20T03:26:51+08:00">
                2019-06-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="点灯"><a href="#点灯" class="headerlink" title="点灯"></a>点灯</h1><p>typedef重定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">typedef unsigned char u8;</span><br><span class="line"></span><br><span class="line">typedef unsigned int u16;</span><br><span class="line">字节数针对keil</span><br></pre></td></tr></table></figure>
<h1 id="流水灯"><a href="#流水灯" class="headerlink" title="流水灯"></a>流水灯</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#define A P0</span><br><span class="line"></span><br><span class="line">#inlcude &quot;intrins.h&quot; // 所在库</span><br><span class="line">_crol_(a,b)  //a为左移的数，b为移动的位数</span><br><span class="line">_cror_(a,b)</span><br></pre></td></tr></table></figure>
<h1 id="中断"><a href="#中断" class="headerlink" title="中断"></a>中断</h1><h2 id="1-原理"><a href="#1-原理" class="headerlink" title="1.原理"></a>1.原理</h2><p>处理某一件事的时候转去干a的时候，转身去做b事情</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">devil0x</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">devil0x</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
